<!doctype html><meta charset="utf-8">
<h3>My Assistant</h3>
<textarea id="prompt" rows="4" style="width:100%" placeholder="Ask for code, text, SQL..."></textarea>
<button id="go">Send</button>
<pre id="out" style="white-space:pre-wrap;max-height:60vh;overflow:auto"></pre>
<script>
const out = document.getElementById('out');
document.getElementById('go').onclick = async () => {
  out.textContent = "";

  const resp = await fetch("/api/generate", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ prompt: document.getElementById('prompt').value })
  });

  if (!resp.ok) {
    const msg = await resp.text();
    out.textContent = `Error ${resp.status}: ${msg}`;
    return;
  }

  const reader = resp.body.getReader();
  const decoder = new TextDecoder();
  while (true) {
    const { value, done } = await reader.read();
    if (done) break;
    out.textContent += decoder.decode(value, { stream: true });
    out.scrollTop = out.scrollHeight;
  }
};
</script>
